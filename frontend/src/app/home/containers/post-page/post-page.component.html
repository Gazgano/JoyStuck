<app-shell *ngIf="callState$ | async as callState">
  <app-loader *ngIf="callState === 'LOADING'" class="PostPage-Loader" palette="primary"></app-loader>

  <div *ngIf="getErrorMessage(callState)" class="PostPage-ErrorPage">
    <div class="PostPage-ErrorPage-Icon">
      <mat-icon color="primary" [inline]="true">error_outline</mat-icon>
    </div>
    <h3>Oups! {{ getErrorMessage(callState) }}</h3>
    <button (click)="refresh()" color="primary" mat-raised-button>Retry</button>
  </div>

  <div class="PostPage-Container" *ngIf="callState === 'LOADED'">
    <div class="PostPage-AddPostActions">
      <button mat-fab color="primary" title="Post a message" (click)="displayEditor('message')"><mat-icon>edit</mat-icon></button>
      <button mat-fab color="warn" title="Share an image" (click)="displayEditor('screenshotShare')"><mat-icon>image</mat-icon></button>
    </div>
    <app-post-editor [postEditorType]="displayedEditor"></app-post-editor>
    <ng-container *ngIf="posts$ | async as posts">
      <div *ngIf="posts && posts.length === 0; else postsList" class="PostPage-ErrorPage">
        <h3>No post to display for now</h3>
        <button (click)="refresh()" color="primary" mat-raised-button>Refresh</button>
      </div>
      
      <ng-template #postsList>
        <app-post-list [posts]="posts" (refresh)="refresh($event)"></app-post-list>
      </ng-template>
    </ng-container>
  </div>
</app-shell>
